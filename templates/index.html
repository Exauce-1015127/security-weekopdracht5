<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8" />
    <title>Encryptie & Decryptie App</title>
    <link rel="stylesheet" href="/static/css/encryption.css">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        textarea { width: 100%; height: 100px; }
        input[type=text], input[type=password] { width: 100%; }
        .section { margin-bottom: 40px; }
        button { padding: 10px 20px; }
        .output { background-color: #f0f0f0; padding: 10px; margin-top: 10px; }
    </style>
</head>
<body>

<h1>Encryptie en Decryptie</h1>

<div class="section">
    <h2>Bericht Versleutelen</h2>
    <form method="post">
        <textarea name="message" placeholder="Typ hier je bericht..."></textarea><br><br>
        <button type="submit" name="encrypt">Versleutel bericht</button>
    </form>
    {% if key_hex %}
        <h3>Gekregen Key (kopieer en bewaar):</h3>


        <div class="output">
            <h4>Versleuteld bericht:</h4>
            <p>Key: {{ key_hex }}</p>
            <p>Nonce: {{ encrypted_data.nonce }}</p>
            <p>Ciphertext: {{ encrypted_data.ciphertext }}</p>
            <p>Tag: {{ encrypted_data.tag }}</p>
        </div>
        <button onclick="downloadData()">Download alle gegevens</button>
    {% endif %}
</div>

<div class="section">
    <h2>Bericht Ontsleutelen</h2>
    <form method="post">
        <label>Key (hex):</label><br>
        <input type="text" name="key" placeholder="Voer de key hex in" required><br><br>
        <label>Nonce (base64):</label><br>
        <input type="text" name="nonce" placeholder="Nonce" required><br><br>
        <label>Ciphertext (base64):</label><br>
        <input type="text" name="ciphertext" placeholder="Ciphertext" required><br><br>
        <label>Tag (base64):</label><br>
        <input type="text" name="tag" placeholder="Tag" required><br><br>
        <button type="submit" name="decrypt">Ontsleutel bericht</button>
    </form>
    {% if decrypted_message is not none %}
        <h3>Gedecrypt bericht:</h3>
        <p>{{ decrypted_message }}</p>
    {% endif %}
</div>

<script src="/static/js/encryption.js">
</script>

</body>
</html>